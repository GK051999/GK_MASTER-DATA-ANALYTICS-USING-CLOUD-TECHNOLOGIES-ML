{"job":{"components":{"4627":{"id":4627,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":240,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4632],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4628":{"id":4628,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":320,"width":32,"height":32,"inputConnectorIDs":[4632],"outputConnectorIDs":[4633],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Relationalize"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT INDEX as \"sql_index\",\n       (\"i\".\"Data Value\":\"loggedTimestamp\")::VARCHAR AS \"loggedTimestamp\",\n       (\"i\".\"Data Value\":\"componentCanvasName\")::VARCHAR AS \"componentCanvasName\",\n       (\"i\".\"Data Value\":\"componentName\")::VARCHAR AS \"componentName\",\n       (\"i\".\"Data Value\":\"endTimestamp\")::NUMBER AS \"endTimestamp\",\n       (\"i\".\"Data Value\":\"environment\":\"database\")::VARCHAR AS \"database\",\n       (\"i\".\"Data Value\":\"environment\":\"schema\")::VARCHAR AS \"schema\",\n       (\"i\".\"Data Value\":\"environment\":\"url\")::VARCHAR AS \"url\",\n       (\"i\".\"Data Value\":\"environment\":\"user\")::VARCHAR AS \"user\",\n       (\"i\".\"Data Value\":\"job\":\"name\")::VARCHAR AS \"name\",\n       (\"i\".\"Data Value\":\"job\":\"type\")::VARCHAR AS \"type\",\n       (\"i\".\"Data Value\":\"sourceUsername\")::VARCHAR AS \"sourceUsername\",\n       (\"f1\".Value:\"dialect\")::VARCHAR AS \"dialect\",\n       (\"f1\".Value:\"query\")::VARCHAR AS \"query\",\n       (\"i\".\"Data Value\":\"startTimestamp\")::NUMBER AS \"startTimestamp\",\n       (\"i\".\"Data Value\":\"urlPath\")::VARCHAR AS \"urlPath\",\n       (\"i\".\"Data Value\":\"sourceConnectionUrl\")::VARCHAR AS \"sourceConnectionUrl\",\n       (\"i\".\"Data Value\":\"taskType\")::VARCHAR AS \"taskType\"\nFROM $T{tmp_lineage_log} \"i\",\n     LATERAL FLATTEN (input => \"i\".\"Data Value\":\"sql\") \"f1\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4629":{"id":4629,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":752,"y":320,"width":32,"height":32,"inputConnectorIDs":[4633],"outputConnectorIDs":[4634],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Determine Run Length"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(\"startTimestamp\" / 1000 )"},"2":{"slot":2,"type":"STRING","value":"start_datetime"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(\"endTimestamp\" / 1000 )"},"2":{"slot":2,"type":"STRING","value":"end_datetime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TIMESTAMPDIFF(second, \"start_datetime\" , \"end_datetime\")"},"2":{"slot":2,"type":"STRING","value":"run_duration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4630":{"id":4630,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":976,"y":320,"width":32,"height":32,"inputConnectorIDs":[4634],"outputConnectorIDs":[4635],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Unify Environment Details"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"dialect\" = 'Snowflake' then \"url\" else \"sourceConnectionUrl\" end"},"2":{"slot":2,"type":"STRING","value":"target_endpoint"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"dialect\" = 'Snowflake' then \"user\" else \"sourceUsername\" end"},"2":{"slot":2,"type":"STRING","value":"target_user"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4631":{"id":4631,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1264,"y":320,"width":32,"height":32,"inputConnectorIDs":[4635],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append to target"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ods_lineage_log"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"loggedTimestamp"},"2":{"slot":2,"type":"STRING","value":"log_logged_timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"start_datetime"},"2":{"slot":2,"type":"STRING","value":"log_start_datetime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"end_datetime"},"2":{"slot":2,"type":"STRING","value":"log_end_datetime"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"run_duration"},"2":{"slot":2,"type":"STRING","value":"log_duration_seconds"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"log_run_type"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"urlPath"},"2":{"slot":2,"type":"STRING","value":"log_job_path"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"},"2":{"slot":2,"type":"STRING","value":"log_operation_type"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dialect"},"2":{"slot":2,"type":"STRING","value":"log_sql_dialect"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"target_endpoint"},"2":{"slot":2,"type":"STRING","value":"log_sql_endpoint"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"target_user"},"2":{"slot":2,"type":"STRING","value":"log_sql_user"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"query"},"2":{"slot":2,"type":"STRING","value":"log_raw_sql"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"sql_index"},"2":{"slot":2,"type":"STRING","value":"log_sql_order"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEMO_SCHEMA"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEMO_DATABASE"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEMO_WAREHOUSE"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"log_logged_timestamp"},"2":{"slot":2,"type":"STRING","value":"Ascending"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"4632":{"id":4632,"sourceID":4627,"targetID":4628},"4633":{"id":4633,"sourceID":4628,"targetID":4629},"4634":{"id":4634,"sourceID":4629,"targetID":4630},"4635":{"id":4635,"sourceID":4630,"targetID":4631}},"notes":{"4621":{"id":4621,"x":149,"y":185,"width":151,"height":184,"text":"This transformation job starts with the newly colocated data in its raw (bronze) form","colour":"00ce4f"},"4622":{"id":4622,"x":333,"y":185,"width":312,"height":185,"text":"Change the granularity of the data to 1 row per SQL statement executed - and extract fields to columns\n\nAlso store the INDEX field from the flatten - to preserve the order of the SQL statements in the array (when a single component executes multiple SQL statements, such as an ingestion component)","colour":"00ce4f"},"4623":{"id":4623,"x":188,"y":73,"width":813,"height":67,"text":"In a medallion data architecture this is a bronze-to-silver layer data transformation.\nIt appends data to the silver layer target table **ods_lineage_log** from the bronze layer source table **tmp_lineage_log**.","colour":"00ce4f"},"4624":{"id":4624,"x":673,"y":184,"width":161,"height":185,"text":"Convert the UNIX-style timestamp fields into Snowflake Timestamps, and calculate a duration","colour":"00ce4f"},"4625":{"id":4625,"x":862,"y":183,"width":240,"height":185,"text":"In the Matillion API all query operations log the currently selected Environment (e.g. Snowflake) - including SQL executed against source systems.\n\nThis calculator creates two fields that log the Snowflake username unless a source username is included","colour":"00ce4f"},"4626":{"id":4626,"x":1149,"y":185,"width":207,"height":184,"text":"This is an INSERT-only append. The high watermark loading approach removes the possibilty of duplication.","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Load Lineage SQL medatada","description":"Load the new data into the SQL log table by transforming it to fit the target table","type":"TRANSFORMATION","tag":"88f5c4c4-3333-4e6d-a424-f7163f77588a"}}